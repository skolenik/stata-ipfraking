. use trip_sample, clear

. wgtcellcollapse sequence , var(daypart) from(2 3 4) depth(3)

. levelsof board_id, local(stations_on)
1 2 8 11 18 24 26 30 36 39 40 44 47 49 50 53 55 60 62 68

. levelsof alight_id, local(stations_off)
2 8 11 18 24 26 30 36 39 40 44 47 49 50 53 55 60 62 68 69

. local all_stations : list stations_on | stations_off

. * relies on stations being in sequential order!!!
. wgtcellcollapse sequence , var(board_id alight_id) from(`all_stations') depth(20)

. save trip_sample_rules, replace
file trip_sample_rules.dta saved
