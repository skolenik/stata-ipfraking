. use trip_sample_rules, clear
{\smallskip}
. wgtcellcollapse collapse, variables(daypart board_id) mincellsize(20) ///
>         generate(dpston1) saving(dpston1.do) replace run
Pass 0 through the data...
  smallest count = 1 in the cell      2000039
  Invoking rule 39:40=23940
  replace dpston1 = 2023940 if inlist(dpston1, 2000039, 2000040)
Pass 1 through the data...
  smallest count = 1 in the cell      2000050
  Invoking rule 50:53=25053
  replace dpston1 = 2025053 if inlist(dpston1, 2000050, 2000053)
Pass 2 through the data...
  smallest count = 1 in the cell      2000055
  Invoking rule 55:25053=35055
  replace dpston1 = 2035055 if inlist(dpston1, 2000055, 2025053)
Pass 3 through the data...
  smallest count = 1 in the cell      3000039
  Invoking rule 39:40=23940
  replace dpston1 = 3023940 if inlist(dpston1, 3000039, 3000040)
\oom
Pass 35 through the data...
  smallest count = 11 in the cell      5031826
  Invoking rule 30:31826=41830
  replace dpston1 = 5041830 if inlist(dpston1, 5000030, 5031826)
Pass 36 through the data...
  smallest count = 12 in the cell      2065068
  WARNING: could not find any rules to collapse dpston1 == 2065068
Pass 37 through the data...
  smallest count = 12 in the cell      3033944
  Invoking rule 26:23036:33944=62644
  replace dpston1 = 3062644 if inlist(dpston1, 3000026, 3023036, 3033944)
\smallskip
\oom
\smallskip
Pass 38 through the data...
  smallest count = 13 in the cell      1000050
  Invoking rule 50:53=25053
  replace dpston1 = 1025053 if inlist(dpston1, 1000050, 1000053)
\smallskip
\oom
\smallskip
Pass 43 through the data...
  smallest count = 14 in the cell      3000055
  Invoking rule 53:55=25355
  replace dpston1 = 3025355 if inlist(dpston1, 3000053, 3000055)
Pass 44 through the data...
  smallest count = 15 in the cell      5104068
  WARNING: could not find any rules to collapse dpston1 == 5104068
Pass 45 through the data...
  smallest count = 17 in the cell      5000062
  Invoking rule 11:18:24:26:30:36:39:40:44:47:49:50:53:55:60:62=161162
  replace dpston1 = 5161162 if inlist(dpston1, 5000011, 5000018, 5000024, 5000026, 5
> 000030, 5000036, 5000039, 5000040, 5000044, 5000047, 5000049, 5000050, 5000053, 50
> 00055, 5000060, 5000062)
Pass 46 through the data...
  smallest count = 18 in the cell      2000062
  Invoking rule 30:36:39:40:44:47:49:50:53:55:60:62=123062
  replace dpston1 = 2123062 if inlist(dpston1, 2000030, 2000036, 2000039, 2000040, 2
> 000044, 2000047, 2000049, 2000050, 2000053, 2000055, 2000060, 2000062)
Pass 47 through the data...
  smallest count = 18 in the cell      3054960
  Invoking rule 62:54960=64962
  replace dpston1 = 3064962 if inlist(dpston1, 3000062, 3054960)
Pass 48 through the data...
  smallest count = 22 in the cell      1023940
  Done collapsing! Exiting...
{\smallskip}
. return list
{\smallskip}
scalars:
         r(arg_min_id) =  1023940
                r(min) =  22
{\smallskip}
macros:
            r(cfailed) : "2065068,5104068"
             r(failed) : "2065068 5104068"
{\smallskip}
. wgtcellcollapse collapse, variables(daypart alight_id) mincellsize(20) ///
>         generate(dpstoff1) saving(dpstoff1.do) replace run
Pass 0 through the data...
  smallest count = 1 in the cell      1000002
  Invoking rule 2:8=20208
  replace dpstoff1 = 1020208 if inlist(dpstoff1, 1000002, 1000008)
Pass 1 through the data...
  smallest count = 1 in the cell      2000008
  Invoking rule 8:11=20811
  replace dpstoff1 = 2020811 if inlist(dpstoff1, 2000008, 2000011)
Pass 2 through the data...
  smallest count = 1 in the cell      2000018
  Invoking rule 18:24=21824
  replace dpstoff1 = 2021824 if inlist(dpstoff1, 2000018, 2000024)
\smallskip
\oom
\smallskip
Pass 37 through the data...
  smallest count = 7 in the cell      5000068
  Invoking rule 62:68=26268
  replace dpstoff1 = 5026268 if inlist(dpstoff1, 5000062, 5000068)
Pass 38 through the data...
  smallest count = 8 in the cell      2044753
  WARNING: could not find any rules to collapse dpstoff1 == 2044753
Pass 39 through the data...
  smallest count = 8 in the cell      4053647
  Invoking rule 30:53647=63047
  replace dpstoff1 = 4063047 if inlist(dpstoff1, 4000030, 4053647)
\smallskip
\oom
\smallskip
Pass 44 through the data...
  smallest count = 10 in the cell      4041126
  Invoking rule 41126:63047=101147
  replace dpstoff1 = 4101147 if inlist(dpstoff1, 4041126, 4063047)
Pass 45 through the data...
  smallest count = 10 in the cell      4055368
  WARNING: could not find any rules to collapse dpstoff1 == 4055368
Pass 46 through the data...
  smallest count = 12 in the cell      1020208
  Invoking rule 20208:21118:24=50224
  replace dpstoff1 = 1050224 if inlist(dpstoff1, 1020208, 1021118, 1000024)
\smallskip
\oom
\smallskip
Pass 52 through the data...
  smallest count = 15 in the cell      3044955
  Invoking rule 44955:60:62=64962
  replace dpstoff1 = 3064962 if inlist(dpstoff1, 3044955, 3000060, 3000062)
Pass 53 through the data...
  smallest count = 16 in the cell      5026268
  Invoking rule 69:26268=36269
  replace dpstoff1 = 5036269 if inlist(dpstoff1, 5000069, 5026268)
Pass 54 through the data...
  smallest count = 22 in the cell      3000047
  Done collapsing! Exiting...
{\smallskip}
. return list
{\smallskip}
scalars:
         r(arg_min_id) =  3000047
                r(min) =  22
{\smallskip}
macros:
            r(cfailed) : "2044753,4055368"
             r(failed) : "2044753 4055368"
